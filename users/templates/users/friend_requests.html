{% extends "base.html" %}

{% block title %}Friend Requests - Goodreads Clone{% endblock %}

{% block content %}
<div class="container py-4">
    <h1>Friend Requests</h1>

    <h3 class="mt-4">Incoming</h3>
    {% if received %}
        <div class="list-group mb-4">
            {% for req in received %}
            <div class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>{{ req.from_user.username }}</strong>
                    <div class="text-muted small">Sent at {{ req.created_at }}</div>
                </div>
                <div>
                    <form method="post" action="{% url 'users:respond_friend_request' req.pk 'accept' %}" style="display:inline">{% csrf_token %}
                        <button class="btn btn-sm btn-success">Accept</button>
                    </form>
                    <form method="post" action="{% url 'users:respond_friend_request' req.pk 'reject' %}" style="display:inline">{% csrf_token %}
                        <button class="btn btn-sm btn-danger">Reject</button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-muted">No incoming requests.</p>
    {% endif %}

    <h3 class="mt-4">Sent</h3>
    {% if sent %}
        <div class="list-group">
            {% for req in sent %}
            <div class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>{{ req.to_user.username }}</strong>
                    <div class="text-muted small">Sent at {{ req.created_at }}</div>
                </div>
                <div>
                    <form method="post" action="{% url 'users:respond_friend_request' req.pk 'cancel' %}">{% csrf_token %}
                        <button class="btn btn-sm btn-secondary">Cancel</button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-muted">You have not sent any friend requests.</p>
    {% endif %}

</div>
{% endblock %}
